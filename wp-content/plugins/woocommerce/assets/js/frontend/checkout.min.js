jQuery(function(a){if("undefined"==typeof wc_checkout_params)return!1;a.blockUI.defaults.overlayCSS.cursor="default";var b={updateTimer:!1,dirtyInput:!1,selectedPaymentMethod:!1,xhr:!1,$order_review:a("#order_review"),$checkout_form:a("form.checkout"),init:function(){a(document.body).bind("update_checkout",this.update_checkout),a(document.body).bind("init_checkout",this.init_checkout),this.$checkout_form.on("click","input[name=\"payment_method\"]",this.payment_method_selected),a(document.body).hasClass("woocommerce-order-pay")&&(this.$order_review.on("click","input[name=\"payment_method\"]",this.payment_method_selected),this.$order_review.on("submit",this.submitOrder),this.$order_review.attr("novalidate","novalidate")),this.$checkout_form.attr("novalidate","novalidate"),this.$checkout_form.on("submit",this.submit),this.$checkout_form.on("input validate change",".input-text, select, input:checkbox",this.validate_field),this.$checkout_form.on("update",this.trigger_update_checkout),this.$checkout_form.on("change","select.shipping_method, input[name^=\"shipping_method\"], #ship-to-different-address input, .update_totals_on_change select, .update_totals_on_change input[type=\"radio\"], .update_totals_on_change input[type=\"checkbox\"]",this.trigger_update_checkout),this.$checkout_form.on("change",".address-field select",this.input_changed),this.$checkout_form.on("change",".address-field input.input-text, .update_totals_on_change input.input-text",this.maybe_input_changed),this.$checkout_form.on("keydown",".address-field input.input-text, .update_totals_on_change input.input-text",this.queue_update_checkout),this.$checkout_form.on("change","#ship-to-different-address input",this.ship_to_different_address),this.$checkout_form.find("#ship-to-different-address input").change(),this.init_payment_methods(),"1"===wc_checkout_params.is_checkout&&a(document.body).trigger("init_checkout"),"yes"===wc_checkout_params.option_guest_checkout&&a("input#createaccount").change(this.toggle_create_account).change()},init_payment_methods:function(){var c=a(".woocommerce-checkout").find("input[name=\"payment_method\"]");1===c.length&&c.eq(0).hide(),b.selectedPaymentMethod&&a("#"+b.selectedPaymentMethod).prop("checked",!0),0===c.filter(":checked").length&&c.eq(0).prop("checked",!0);var d=c.filter(":checked").eq(0).prop("id");1<c.length&&a("div.payment_box:not(\"."+d+"\")").filter(":visible").slideUp(0),c.filter(":checked").eq(0).trigger("click")},get_payment_method:function(){return b.$checkout_form.find("input[name=\"payment_method\"]:checked").val()},payment_method_selected:function(c){if(c.stopPropagation(),1<a(".payment_methods input.input-radio").length){var d=a("div.payment_box."+a(this).attr("ID")),e=a(this).is(":checked");e&&!d.is(":visible")&&(a("div.payment_box").filter(":visible").slideUp(230),e&&d.slideDown(230))}else a("div.payment_box").show();a(this).data("order_button_text")?a("#place_order").text(a(this).data("order_button_text")):a("#place_order").text(a("#place_order").data("value"));var f=a(".woocommerce-checkout input[name=\"payment_method\"]:checked").attr("id");f!==b.selectedPaymentMethod&&a(document.body).trigger("payment_method_selected"),b.selectedPaymentMethod=f},toggle_create_account:function(){a("div.create-account").hide(),a(this).is(":checked")&&(a("#account_password").val("").change(),a("div.create-account").slideDown())},init_checkout:function(){a(document.body).trigger("update_checkout")},maybe_input_changed:function(a){b.dirtyInput&&b.input_changed(a)},input_changed:function(a){b.dirtyInput=a.target,b.maybe_update_checkout()},queue_update_checkout:function(a){var c=a.keyCode||a.which||0;return!(9!==c)||void(b.dirtyInput=this,b.reset_update_checkout_timer(),b.updateTimer=setTimeout(b.maybe_update_checkout,"1000"))},trigger_update_checkout:function(){b.reset_update_checkout_timer(),b.dirtyInput=!1,a(document.body).trigger("update_checkout")},maybe_update_checkout:function(){var c=!0;if(a(b.dirtyInput).length){var d=a(b.dirtyInput).closest("div").find(".address-field.validate-required");d.length&&d.each(function(){""===a(this).find("input.input-text").val()&&(c=!1)})}c&&b.trigger_update_checkout()},ship_to_different_address:function(){a("div.shipping_address").hide(),a(this).is(":checked")&&a("div.shipping_address").slideDown()},reset_update_checkout_timer:function(){clearTimeout(b.updateTimer)},is_valid_json:function(b){try{var c=a.parseJSON(b);return c&&"object"==typeof c}catch(a){return!1}},validate_field:function(b){var c=a(this),d=c.closest(".form-row"),e=!0,f=d.is(".validate-required"),g=d.is(".validate-email"),h=b.type;if("input"===h&&d.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-validated"),"validate"===h||"change"===h){if(f&&("checkbox"!==c.attr("type")||c.is(":checked")?""===c.val()&&(d.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),e=!1):(d.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),e=!1)),g&&c.val()){var i=new RegExp(/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i);i.test(c.val())||(d.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-email"),e=!1)}e&&d.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email").addClass("woocommerce-validated")}},update_checkout:function(a,c){b.reset_update_checkout_timer(),b.updateTimer=setTimeout(b.update_checkout_action,"5",c)},update_checkout_action:function(c){if(b.xhr&&b.xhr.abort(),0!==a("form.checkout").length){c="undefined"==typeof c?{update_shipping_method:!0}:c;var d=a("#billing_country").val(),e=a("#billing_state").val(),f=a(":input#billing_postcode").val(),g=a("#billing_city").val(),h=a(":input#billing_address_1").val(),i=a(":input#billing_address_2").val(),j=d,k=e,l=f,m=g,n=h,o=i,p=a(b.$checkout_form).find(".address-field.validate-required:visible"),q=!0;p.length&&p.each(function(){""===a(this).find(":input").val()&&(q=!1)}),a("#ship-to-different-address").find("input").is(":checked")&&(j=a("#shipping_country").val(),k=a("#shipping_state").val(),l=a(":input#shipping_postcode").val(),m=a("#shipping_city").val(),n=a(":input#shipping_address_1").val(),o=a(":input#shipping_address_2").val());var r={security:wc_checkout_params.update_order_review_nonce,payment_method:b.get_payment_method(),country:d,state:e,postcode:f,city:g,address:h,address_2:i,s_country:j,s_state:k,s_postcode:l,s_city:m,s_address:n,s_address_2:o,has_full_address:q,post_data:a("form.checkout").serialize()};if(!1!==c.update_shipping_method){var s={};a("select.shipping_method, input[name^=\"shipping_method\"][type=\"radio\"]:checked, input[name^=\"shipping_method\"][type=\"hidden\"]").each(function(){s[a(this).data("index")]=a(this).val()}),r.shipping_method=s}a(".woocommerce-checkout-payment, .woocommerce-checkout-review-order-table").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),b.xhr=a.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","update_order_review"),data:r,success:function(c){if(c&&!0===c.reload)return void window.location.reload();a(".woocommerce-NoticeGroup-updateOrderReview").remove();var d=a("#terms").prop("checked"),e={};if(a(".payment_box :input").each(function(){var b=a(this).attr("id");b&&(-1===a.inArray(a(this).attr("type"),["checkbox","radio"])?e[b]=a(this).val():e[b]=a(this).prop("checked"))}),c&&c.fragments&&(a.each(c.fragments,function(c,d){b.fragments&&b.fragments[c]===d||a(c).replaceWith(d),a(c).unblock()}),b.fragments=c.fragments),d&&a("#terms").prop("checked",!0),a.isEmptyObject(e)||a(".payment_box :input").each(function(){var b=a(this).attr("id");b&&(-1===a.inArray(a(this).attr("type"),["checkbox","radio"])?-1===a.inArray(a(this).attr("type"),["select"])?null!==a(this).val()&&0===a(this).val().length&&a(this).val(e[b]).change():a(this).val(e[b]).change():a(this).prop("checked",e[b]).change())}),c&&"failure"===c.result){var f=a("form.checkout");a(".woocommerce-error, .woocommerce-message").remove(),c.messages?f.find(".checkoutLeftSide").prepend("<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-updateOrderReview\">"+c.messages+"</div>"):f.find(".checkoutLeftSide").prepend(c),f.find(".input-text, select, input:checkbox").trigger("validate").blur(),b.scroll_to_notices()}b.init_payment_methods(),a(document.body).trigger("updated_checkout",[c])}})}},handleUnloadEvent:function(a){return!(-1!==navigator.userAgent.indexOf("MSIE")||document.documentMode)||void a.preventDefault()},attachUnloadEventsOnSubmit:function(){a(window).on("beforeunload",this.handleUnloadEvent)},detachUnloadEventsOnSubmit:function(){a(window).unbind("beforeunload",this.handleUnloadEvent)},blockOnSubmit:function(a){var b=a.data();1!==b["blockUI.isBlocked"]&&a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},submitOrder:function(){b.blockOnSubmit(a(this))},submit:function(){b.reset_update_checkout_timer();var c=a(this);return!c.is(".processing")&&(!1!==c.triggerHandler("checkout_place_order")&&!1!==c.triggerHandler("checkout_place_order_"+b.get_payment_method())&&(c.addClass("processing"),b.blockOnSubmit(c),b.attachUnloadEventsOnSubmit(),a.ajaxSetup({dataFilter:function(a,c){if("json"!==c)return a;if(b.is_valid_json(a))return a;var d=a.match(/{"result.*}/);return null===d?console.log("Unable to fix malformed JSON"):b.is_valid_json(d[0])?(console.log("Fixed malformed JSON. Original:"),console.log(a),a=d[0]):console.log("Unable to fix malformed JSON"),a}}),a.ajax({type:"POST",url:wc_checkout_params.checkout_url,data:c.serialize(),dataType:"json",success:function(c){b.detachUnloadEventsOnSubmit();try{if("success"===c.result)window.location=-1===c.redirect.indexOf("https://")||-1===c.redirect.indexOf("http://")?c.redirect:decodeURI(c.redirect);else if("failure"===c.result)throw"Result failure";else throw"Invalid response"}catch(d){if(!0===c.reload)return void window.location.reload();!0===c.refresh&&a(document.body).trigger("update_checkout"),c.messages?b.submit_error(c.messages):b.submit_error("<div class=\"woocommerce-error\">"+wc_checkout_params.i18n_checkout_error+"</div>")}},error:function(a,c,d){b.detachUnloadEventsOnSubmit(),b.submit_error("<div class=\"woocommerce-error\">"+d+"</div>")}})),!1)},submit_error:function(c){a(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),b.$checkout_form.find(".checkoutLeftSide").prepend("<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout\">"+c+"</div>"),b.$checkout_form.removeClass("processing").unblock(),b.$checkout_form.find(".input-text, select, input:checkbox").trigger("validate").blur(),b.scroll_to_notices(),a(document.body).trigger("checkout_error")},scroll_to_notices:function(){var b=a(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");b.length||(b=a(".form.checkout")),a.scroll_to_notices(b)}};b.init(),{init:function(){a(document.body).on("click","a.showcoupon",this.show_coupon_form),a(document.body).on("click",".woocommerce-remove-coupon",this.remove_coupon),a("form.checkout_coupon").hide().submit(this.submit)},show_coupon_form:function(){return a(".checkout_coupon").slideToggle(400,function(){a(".checkout_coupon").find(":input:eq(0)").focus()}),!1},submit:function(){var b=a(this);if(b.is(".processing"))return!1;b.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var c={security:wc_checkout_params.apply_coupon_nonce,coupon_code:b.find("input[name=\"coupon_code\"]").val()};return a.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","apply_coupon"),data:c,success:function(d){a(".woocommerce-error, .woocommerce-message").remove(),b.removeClass("processing").unblock(),d&&(b.before(d),b.slideUp(),a(document.body).trigger("applied_coupon_in_checkout",[c.coupon_code]),a(document.body).trigger("update_checkout",{update_shipping_method:!1}))},dataType:"html"}),!1},remove_coupon:function(b){b.preventDefault();var c=a(this).parents(".woocommerce-checkout-review-order"),d=a(this).data("coupon");c.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={security:wc_checkout_params.remove_coupon_nonce,coupon:d};a.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","remove_coupon"),data:e,success:function(b){a(".woocommerce-error, .woocommerce-message").remove(),c.removeClass("processing").unblock(),b&&(a("form.woocommerce-checkout").before(b),a(document.body).trigger("update_checkout",{update_shipping_method:!1}),a("form.checkout_coupon").find("input[name=\"coupon_code\"]").val(""))},error:function(a){wc_checkout_params.debug_mode&&console.log(a.responseText)},dataType:"html"})}}.init(),{init:function(){a(document.body).on("click","a.showlogin",this.show_login_form)},show_login_form:function(){return a("form.login, form.woocommerce-form--login").slideToggle(),!1}}.init(),{init:function(){a(document.body).on("click","a.woocommerce-terms-and-conditions-link",this.toggle_terms)},toggle_terms:function(){if(a(".woocommerce-terms-and-conditions").length)return a(".woocommerce-terms-and-conditions").slideToggle(function(){var b=a(".woocommerce-terms-and-conditions-link");a(".woocommerce-terms-and-conditions").is(":visible")?(b.addClass("woocommerce-terms-and-conditions-link--open"),b.removeClass("woocommerce-terms-and-conditions-link--closed")):(b.removeClass("woocommerce-terms-and-conditions-link--open"),b.addClass("woocommerce-terms-and-conditions-link--closed"))}),!1}}.init()});